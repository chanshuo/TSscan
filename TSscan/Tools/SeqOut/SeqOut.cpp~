#include <string.h>
#include "../../cswu/Common.h"
#include "../../cswu/Table.h"
#include "../../cswu/Seq.h"
#include "../../cswu/IsInList.h"

void PrintUsage();

int main(int argc, char **argv)
{
	Str2BoolMap theMap;

	if(argc != 3)
	{	PrintUsage();	return 1;	}	

	theMap.AddIntoMap( argv[1], atoi(argv[2])-1 );

	for( Sequence seq; seq.Get(); )
	{
		if( theMap.IsInMap(seq.Name()) )
			seq.Print();
	}

	return 0;
}

void PrintUsage()
{
	ErrMsg("Output the listed sequences.\n\n");

	ErrMsg("SeqOut [List] [Key]\n\n");

	ErrMsg("[Input]         STRING      A FASTA format file.\n");
	ErrMsg("[List]          FILE        The filename of a table as the list.\n");
	ErrMsg("[Key]           INTEGER     The key column in the list.\n");
	ErrMsg("[Output]        STRING      \n\n");

	ErrMsg("Example:\n");
	ErrMsg("SeqOut list.txt 1 < est.fa > result.txt\n");
	ErrMsg("SeqOut est.fa list.txt 1 result.txt\n\n");
}
